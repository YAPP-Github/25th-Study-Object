# 3장 역할, 책임, 협력

## 협력

> 협력이란 어떤 객체가 다른 객체에게 무엇인가를 요청하는 것이다. 한 객체는 어떤 것이 필요할 때 다른 객체에게 전적으로 위임하거나 서로 협력한다. 즉, 두 객체가 상호작용을 통해 더 큰 책임을 수행하는 것이다. 객체 사이의 협력을 설계할 때는 객체를 서로 분리된 인스턴스가 아닌 협력하는 파트너로 인식해야 한다.
>

> 자율적인 객체는 자신에게 할당된 책임을 수행하던 중에 필요한 정보를 알지 못하거나 외부의 도움이 필요한 경우 적절한 객체에게 메시지를 전송해서 협력을 요청한다.
메시지를 수신한 객체 역시 메시지를 처리하던 중에 직접 처리할 수 없는 정보나 행동이 필요한 경우 또 다른 객체에게 도움을 요청한다.
이처럼 객체들 사이의 협력을 구성하는 일련의 요청과 응답의 흐름을 통해 애플리케이션의 기능이 구현된다.
>

> 협력이라는 문맥을 고려하지 않고 Movie의 행동을 결정하는 것은 아무런 의미가 없다.
객체의 행동을 결정하는 것이 협력이라면 객체의 상태를 결정하는 것이 행동이다.
협력이 객체를 구성하는 행동과 상태 모두를 결정한다.
>

## 책임

### 책임이란 무엇인가

> 객체의 책임은 객체가 ‘무엇을 알고 있는가’와 ‘무엇을 할 수 있는가’로 구성된다.
>
- 하는 것
    - 객체를 생성하거나 계산을 수행하는 등의 스스로 하는 것
    - 다른 객체의 행동을 시작시키는 것
    - 다른 객체의 활동을 제어하고 조절하는 것
- 아는 것
    - 사적인 정보에 관해 아는 것
    - 관련된 객체에 관해 아는 것
    - 자신이 유도하거나 계산할 수 잇는 것에 관해 아는 것

> 책임은 객체가 수행할 수 있는 행동을 종합적이고 간략하게 서술하기 때문에 메시지보다 추상적이고 개념적으로도 더 크다.
객체는 자신이 맡은 책임을 수행하는 데 필요한 정보를 알고 있을 책임이 있다. 또한 객체는 자신이 할 수 없는 작업을 도와줄 객체를 알고 있을 책임이 있다.
>

<aside>
💡

객체에게 얼마나 적절한 책임을 할당하느냐가 설계의 전체적인 품질을 결정한다.

</aside>

### 책임 할당

- 정보 전문가 패턴
    - 책임을 수행하는 데 필요한 정보를 가장 잘 알고 있는 전문가에게 그 책임을 할당하는 것

> 책임을 할당한다는 것은 메시지의 이름을 결정하는 것과 같다
메시지가 메시지를 수신할 객체의 책임을 결정한다
>

<aside>
💡

정보 전문가에게 책임을 할당하는 것만으로도 상태와 행동을 함께 가지는 자율적인 객체를 만들 가능성이 높아진다.

</aside>

### 책임 주도 설계

> 협력이 책임을 이끌어내고 책임이 협력에 참여할 객체를 결정한다.
>

책임을 할당할 때 고려해야하는 두가지 요소

1. 메시지가 객체를 결정한다
    1. 최소한의 인터페이스를 가질 수 있게 된다.
        1. 필요한 메시지가 식별될 때까지 객체의 퍼블릭 인터페이스에 어떤 것도 추가하지 않기 때문에 객체는 애플리케이션에 크지도, 작지도 않은 꼭 필요한 크기의 퍼블릭 인터페이스를 가질 수 있다.
    2. 추상적인 인터페이스를 가질 수 있게 된다.
2. 행동이 상태를 결정한다
    1. 상태는 단지 객체가 행동을 정상적으로 수행하기 위해 필요한 재료일 뿐이기 때문.
        1. 중요한 것은 객체의 상태가 아니라 행동이다.
    2. 상태는 행동을 결정하고 나서야 비로소 결정할 수 있다.

> 협력이 객체의 행동을 결정하고 행동이 상태를 결정한다.
>

## 역할

> 객체가 어떤 특정한 협력 안에서 수행하는 책임의 집합을 역할이라고 부른다.
>

<aside>
💡

역할이 없어도 객체만으로 충분히 협력을 설계할 수 있는 것 아닌가?

→ 객체가 여러개인 상황에서 여러개의 메시지나 협력을 불필요하게 중복으로 만들어야하는데
역할이라는 책임의 집합이 있으면 중복을 제거하고 더 유연한 설계를 할 수 있다.
→ 책임에 초점을 맞추게됨

</aside>

> 역할은 다른 것으로 교체할 수 있는 책임의 집합이다.
>

- DiscountPolicy - 역할
    - AmountDiscountPolicy - 책임1
    - PercentDiscountPolicy - 책임2
    - NoneDiscountPolicy - 책임3
    - …

> 역할의 구현은 추상 클래스와 인터페이스를 사용하는 것이다.
>

### 객체 대 역할

> 역할은 객체가 참여할 수 있는 일종의 슬롯이다.
>

<aside>
💡

설계 초반에 애매하다면 단순하게 객체로 시작하고 반복적으로 책임과 협력을 정제해가면서
필요한 순간에 객체로부터 역할을 분리해내는 것이 가장 좋은 방법.

</aside>

> 역할의 가장 큰 장점은 설계의 구성 요소를 추상화 할 수 있다는 것이다.
>

### 역할과 추상화

DiscountPolicy나 DiscountCondition이 역할(인터페이스) 다.

협력이라는 관점에서 세부적인 사항을 무시하고 추상화에 집중하여 유용하게 만듬

### 배우와 배역

> 배역과 배우 간의 관계에 다음과 같은 특성이 존재
1. 배역은 연극 배우가 특정 연극에서 연기하는 역할이다.
2. 배역은 상영되는 동안에만 존재하는 일시적인 개념이다.
3. 연극이 끝나면 원래의 배우로 돌아온다.
4. 서로 다른 배우들이 동일한 배역을 연기할 수 있다.
5. 하나의 배우가 다양한 연극 안에서 서로 다른 배역을 연기할 수 있다.
>

<aside>
💡

객체 역시 여러 협력에 참여하면서 다양한 역할을 수행할 수 있다.
→ 객체는 다양한 역할을 가질 수 있다.
(협력에 필요한 부분을 제외한 나머지 부분은 감춰진다.)

</aside>